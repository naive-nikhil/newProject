---
// frontmatter: slides array (edit/add slides here)
const slides = [
  {
    id: "s1",

    imageHtml: `<div class="text-5xl select-none" aria-hidden="true">üü¶</div>`,
    title: "‚ÄúCreate a Story‚Äù",
    text: "Shaping narratives that connect deeply with your audience.",
  },
  {
    id: "s2",

    imageHtml: `<div class="text-5xl select-none" aria-hidden="true">üü©</div>`,
    title: "‚ÄúUnderstand Your Audience‚Äù",
    text: " Precisely target the right group for impactful marketing.",
  },
  {
    id: "s3",

    imageHtml: `<div class="text-5xl select-none" aria-hidden="true">üü®</div>`,
    title: "‚ÄúBoost Your Online Presence‚Äù",
    text: "Ensure a massive, relevant, and authentic digital footprint",
  },
  {
    id: "s4",

    imageHtml: `<div class="text-5xl select-none" aria-hidden="true"></div>`,
    title: "‚ÄúMultichannel Activation‚Äù",
    text: "Build a strong presence across websites, social media, Google, and LinkedIn.",
  },
];
---

<style>
  .mainDiv h2 {
    font-size: 1.5rem;
    line-height: 2.25rem;
    text-align: center;
  }
  @media (min-width: 780px) {
    .mainDiv h2 {
      font-size: 2.75rem;
      line-height: 4.25rem;
      text-align: left;
    }
  }
  @media (max-width: 990px) {
    .imageTesti {
      display: none;
    }
  }
  @media (min-width: 1200px) {
    .mainDiv h2 {
      font-size: 2rem;
    }
  }
  @media (min-width: 1400px) {
    .mainDiv h2 {
      font-size: 3.7rem;
    }
  }

  .slide-item {
    transition:
      opacity 300ms ease,
      transform 300ms ease;
  }
  .hidden {
    display: none !important;
  }
  .slide-visible {
    display: flex !important;
    opacity: 1;
    transform: translateY(0);
  }
  .slide-hidden {
    opacity: 0;
    transform: translateY(8px);
  }

  .controls {
    display: inline-flex;
    gap: 0.5rem;
  }
  .control-btn {
    width: 2rem;
    height: 2rem;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 0.5rem;
    cursor: pointer;
  }
  .control-btn:focus {
    outline: 2px solid rgba(0, 0, 0, 0.12);
    outline-offset: 2px;
  }

  /* small visual niceties for dots */
  .dot {
    width: 0.65rem;
    height: 0.65rem;
    border-radius: 9999px;
  }
  .dot.active {
    background: #000;
  }
  .dot.inactive {
    background: #ddd;
  }
</style>

<div
  class="w-screen flex justify-center"
  data-scroll-speed="1"
  data-scroll
  data-scroll-offset="100"
>
  <div class="bg-white w-[80%] py-20 font-san mainDiv">
    <h2
      class="text-[1.5rem] text-[#474747] sm:text-left md:text-left lg:text-center mb-10"
    >
      Our Roles
    </h2>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-16 max-w-5xl">
      <p class="text-lg text-gray-700 leading-relaxed font-light">
        For any brand or business, storytelling is the foundation of brand
        building.
      </p>
      <p class="text-lg text-gray-700 leading-relaxed font-light">
        But with projects to deliver and timelines to keep in check, who has got
        your back to keep scanning and saving on what you dish out every month?
        <strong>Stable.</strong>
      </p>
    </div>
  </div>
</div>

<div class="font-sans py-10">
  <div class="flex items-center space-x-4 md:space-x-6">
    <div class="w-full">
      <!-- map slides -->
      {
        slides.map((slide, i) => (
          <div
            key={slide.id}
            class={`flex  bg-gradient-to-br from-[#047bca]/50 via-white to-[#047bca]/50  flex-col md:flex-row slide-item max-w-7xl mx-auto shadow-xl rounded-2xl overflow-hidden ${i === 0 ? "slide-visible" : "hidden slide-hidden"}`}
            data-index={i}
          >
            <div class="flex border-[#d3ecfd] border-2 imageTesti items-center justify-center h-16 md:p-16 mr-6 rounded-2xl w-full md:w-1/3 min-h-[250px]">
              <div innerHTML={slide.imageHtml} />
            </div>

            <div class="flex   flex-col bg-gradient-to-br from-[#047bca]/50 via-white to-[#047bca]/50 justify-center min-h-36 items-center text-left rounded-2xl w-full md:w-full">
              <blockquote class="text-3xl sm:text-4xl font-normal text-gray-600 leading-snug mb-6">
                {slide.title}
              </blockquote>
              <p class="text-lg text-gray-600">{slide.text}</p>
            </div>
          </div>
        ))
      }
    </div>
  </div>

  <div
    class="flex space-x-2 mt-8 max-w-5xl mx-auto px-4 md:px-0 items-center justify-between"
  >
    <div class="controls">
      <button
        class="control-btn prev h-9 flex items-center justify-center bg-black text-white rounded-xl transition-colors hover:bg-gray-700"
        aria-label="Previous slide"
        title="Previous"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M15 19l-7-7 7-7"></path>
        </svg>
      </button>

      <button
        class="control-btn next h-9 flex items-center justify-center bg-black text-white rounded-xl transition-colors hover:bg-gray-700"
        aria-label="Next slide"
        title="Next"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 5l7 7-7 7"></path>
        </svg>
      </button>
    </div>

    <div class="dots flex items-center gap-2" aria-hidden="false">
      {
        slides.map((_, i) => (
          <button
            class={`dot ${i === 0 ? "active" : "inactive"}`}
            data-dot-index={i}
            aria-label={`Go to slide ${i + 1}`}
            title={`Slide ${i + 1}`}
          />
        ))
      }
    </div>
  </div>
</div>

<!-- Inline script so Astro runs it client-side -->
<script>
  document.addEventListener("DOMContentLoaded", () => {
    // 1. Select all slide items using querySelectorAll
    const slides = document.querySelectorAll(".slide-item");
    // 2. Select buttons correctly by getting the first element of the collection
    const prevButton = document.getElementsByClassName("prev")[0];
    const nextButton = document.getElementsByClassName("next")[0];
    // select dots
    const dots = document.querySelectorAll("[data-dot-index]");
    let currentSlide = 0;

    function showSlide(index) {
      // guard: no slides
      if (!slides || slides.length === 0) return;

      // hide all slides
      slides.forEach((slide) => {
        slide.style.display = "none";
        slide.classList.remove("slide-visible");
        slide.classList.add("slide-hidden");
      });

      // normalize index (wrap-around)
      index = ((index % slides.length) + slides.length) % slides.length;

      // show the requested slide
      slides[index].style.display = "flex";
      slides[index].classList.remove("slide-hidden");
      slides[index].classList.add("slide-visible");

      // update dots
      if (dots && dots.length) {
        dots.forEach((d, i) => {
          if (i === index) {
            d.classList.remove("inactive");
            d.classList.add("active");
          } else {
            d.classList.remove("active");
            d.classList.add("inactive");
          }
        });
      }

      currentSlide = index;
    }

    function nextSlide() {
      // Use slides.length
      currentSlide = (currentSlide + 1) % slides.length;
      showSlide(currentSlide);
    }

    function prevSlide() {
      // handle wrap-around correctly
      currentSlide = (currentSlide - 1 + slides.length) % slides.length;
      showSlide(currentSlide);
    }

    // Attach listeners to the button elements
    if (nextButton) {
      nextButton.addEventListener("click", nextSlide);
    }
    if (prevButton) {
      prevButton.addEventListener("click", prevSlide);
    }

    // Attach listeners to dots if present
    if (dots && dots.length) {
      dots.forEach((dot) => {
        dot.addEventListener("click", (e) => {
          const idx = Number(dot.getAttribute("data-dot-index"));
          if (!Number.isNaN(idx)) showSlide(idx);
        });
      });
    }

    // Initialize: show the first slide
    showSlide(currentSlide);
  });
</script>
