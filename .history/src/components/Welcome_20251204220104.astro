---
import technovel from "../assets/technovel_logo.png";
import { Icon } from "astro-icon/components";
---

<style>
  /* FIX: remove nested media query from original and make responsive rules valid */
  @media (min-width: 780px) {
    .mainDiv h2 {
      font-size: 2.75rem;
      line-height: 4.25rem;
    }
  }

  @media (min-width: 1200px) {
    .mainDiv h2 {
      font-size: 2rem;
    }
  }

  /* Page base */
  #hero-root {
    position: relative;
    overflow: visible;
    background: linear-gradient(
      135deg,
      rgba(240, 249, 255, 0.9) 0%,
      rgba(255, 255, 255, 0.85) 50%,
      rgba(235, 246, 255, 0.9) 100%
    );
  }

  /* Blob improvements: layered, GPU-accelerated, varied opacity */
  .blob1 {
    will-change: transform, opacity;
    pointer-events: none;
    filter: blur(28px);
    transition:
      transform 0.6s ease,
      opacity 0.6s ease;
  }

  /* subtle shadows and rounded bottom */
  #hero-root > div:first-child {
    border-bottom-left-radius: 2rem;
    border-bottom-right-radius: 2rem;
  }

  /* Logo and heading */
  img[alt="Stable Logo"],
  img[alt="Technovel logo"] {
    display: block;
    max-width: 100%;
    height: auto;
  }

  h1 {
    color: #0f172a; /* slate-900 */
    font-weight: 800;
    letter-spacing: -0.01em;
  }

  /* Button polish */
  .cta-btn {
    padding: 0.95rem 1.75rem;
    border-radius: 0.75rem;
    background: linear-gradient(90deg, #006ab2 0%, #013456 100%);
    color: white;
    font-weight: 600;
    box-shadow: 0 10px 25px rgba(1, 58, 86, 0.12);
    transition:
      transform 200ms ease,
      box-shadow 200ms ease;
    display: inline-flex;
    align-items: center;
    gap: 0.6rem;
  }

  .cta-btn:hover {
    transform: translateY(-4px) scale(1.02);
    box-shadow: 0 18px 35px rgba(1, 58, 86, 0.14);
  }

  /* Image container improvements while preserving structure */
  .preview-card {
    border-radius: 1rem;
    overflow: hidden;
    display: block;
    box-shadow: 0 18px 40px rgba(15, 23, 42, 0.08);
    border: 1px solid rgba(15, 23, 42, 0.04);
    background: linear-gradient(
      180deg,
      rgba(255, 255, 255, 0.6),
      rgba(255, 255, 255, 0.45)
    );
  }

  .preview-card img {
    display: block;
    width: 100%;
    height: auto;
    object-fit: cover;
    transition:
      transform 600ms cubic-bezier(0.2, 0.9, 0.3, 1),
      opacity 600ms;
    transform-origin: center;
  }

  /* make image slightly pop on load */
  .preview-card img.loaded {
    transform: translateY(0) scale(1);
    opacity: 1;
  }

  /* reduced motion preference */
  @media (prefers-reduced-motion: reduce) {
    .cta-btn,
    .blob1,
    .preview-card img {
      transition: none !important;
    }
  }

  /* Responsive tweaks to spacing to keep original layout intact */
  .w-[25vw] {
    /* utility kept from original â€” define fallback for browsers that don't support arbitrary classes in some setups */
    width: 25vw;
  }

  /* Fix minor typos/typo classes from original (sm:-h[20%] etc) with safer rules */
  .card-wrapper {
    width: 80%;
    margin-top: 5vh;
    border-radius: 1rem;
    display: flex;
    justify-content: center;
    align-items: center;
  }
</style>

<div
  id="hero-root"
  class="flex bg-white/70 shadow-zinc-400 justify-center items-center w-full rounded-b-4xl flex-col"
>
  <div
    class="w-full lg:h-[55vh] flex justify-center mx-auto items-center flex-col px-4"
  >
    <!-- decorative left blob (kept positions but refined style) -->
    <div
      class="blob1 absolute top-[20%] left-0 -translate-y-1/2
         w-[25vw] h-[25vw] md:w-[20vw] md:h-[20vw] lg:w-[24vw] lg:h-[24vw]
         bg-[#047bca] opacity-10 blur-3xl rounded-full z-0"
    >
    </div>

    <img
      class="max-w-[538px] h-auto lg:w-[25vw]"
      src={technovel.src}
      alt="Stable Logo"
    />

    <h1
      class="text-[1.75rem] z-30 leading-[2.375rem] max-w-[900px] sm:text-4xl py-2 mt-[23px] font-bold text-center"
    >
      Next-Gen Digital Solutions
    </h1>
    <button class="cta-btn mt-5">
      <span>Join Now</span>
    </button>
  </div>

  <!-- right decorative blob (kept) -->
  <div
    class="blob1 absolute top-[50%] right-0 -translate-y-1/2
         w-[25vw] h-[25vw] md:w-[20vw] md:h-[20vw] lg:w-[24vw] lg:h-[24vw]
         bg-[#047bca] opacity-10 blur-3xl rounded-full z-0"
  >
  </div>
  <div
    class="h-screen md:h-screen w-full flex justify-center items-center mt-[5vh]"
  >
    <div
      class="card-wrapper w-[80%] rounded-3xl sm:-h[20%] md:-[40%] bg-gradient-to-t from- zinc-300/30 to-[#047bca]/30 lg:h-[50%] border-zinc-200 border-2 flex justify-center items-end preview-card"
    >
      <img
        class="max-w-[1020px] shadow-2xl shadow-zinc-500 rounded-3xl w-[95%] sm:w-[70%] lg:h-[80vh] md:h-[70vh] sm:h-[50vh] object-cover md:w-[70%]"
        src="https://www.sivilsayfalar.org/wp-content/uploads/2020/01/7e86ee8cf65b4e7eb1979f90d557af6a-e1578640341576.jpg"
        alt="Stable App Dashboard Preview"
      />
    </div>
  </div>
</div>

<script type="module" defer>
  import gsap from "https://cdn.jsdelivr.net/npm/gsap@3.12.5/index.js";
  import { ScrollTrigger } from "https://cdn.jsdelivr.net/npm/gsap@3.12.5/ScrollTrigger.min.js";

  gsap.registerPlugin(ScrollTrigger);

  const blob = document.querySelectorAll(".blob1");
  const hero = document.querySelector("#hero-root"); // The trigger element
  const previewImg = document.querySelector(".preview-card img");

  // ensure elements exist before animating
  if (blob && hero) {
    // make into array and animate with different intensities
    blob.forEach((b, i) => {
      const travel = 120 + i * 20;
      gsap.fromTo(
        b,
        { y: 0, opacity: 1, scale: 1 },
        {
          y: travel,
          opacity: 0.08,
          scale: 0.9,
          ease: "power1.out",
          scrollTrigger: {
            trigger: hero,
            start: "top top",
            end: "bottom top",
            scrub: true,
          },
        }
      );
    });
  } else {
    console.warn(
      "GSAP/ScrollTrigger failed: 'blob' or 'hero' element not found."
    );
  }

  // image reveal: add loaded class when fully loaded for subtle pop
  if (previewImg) {
    if (previewImg.complete) {
      previewImg.classList.add("loaded");
    } else {
      previewImg.addEventListener("load", () =>
        previewImg.classList.add("loaded")
      );
    }
  }
</script>
